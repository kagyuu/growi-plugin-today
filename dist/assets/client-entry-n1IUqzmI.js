const x="growi-plugin-today-embed",F="1.0.0",j="GROWI plugin for embed today",M="MIT",N=["growi","growi-plugin"],O="module",S={dev:"vite",build:"tsc && vite build",preview:"vite preview"},G={react:"^18.3.1","react-dom":"^18.3.1","react-innertext":"^1.1.5",unified:"^11.0.5","unist-util-visit":"^5.0.0"},E={"@types/react":"^18.3.3","@types/react-dom":"^18.3.0","@typescript-eslint/eslint-plugin":"^5.0.0","@typescript-eslint/parser":"^5.0.0","@vitejs/plugin-react":"^4.3.1",eslint:"^8.18.0","eslint-config-next":"^14.2.4","eslint-config-weseek":"^2.1.0","eslint-import-resolver-typescript":"^3.2.5","eslint-plugin-import":"^2.29.1","eslint-plugin-jest":"^27.1.0","eslint-plugin-react":"^7.30.1","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-regex":"^1.10.0",jest:"^29.7.0",typescript:"^5.5.2",vite:"^5.3.2"},L={schemaVersion:"4",types:["script"]},f={name:x,version:F,description:j,license:M,keywords:N,type:O,scripts:S,dependencies:G,devDependencies:E,growiPlugin:L},A=function(e){if(e==null)return V;if(typeof e=="function")return w(e);if(typeof e=="object")return Array.isArray(e)?R(e):W(e);if(typeof e=="string")return C(e);throw new Error("Expected function, string, or object as test")};function R(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=A(e[n]);return w(o);function o(...i){let c=-1;for(;++c<t.length;)if(t[c].apply(this,i))return!0;return!1}}function W(e){const t=e;return w(n);function n(o){const i=o;let c;for(c in e)if(i[c]!==t[c])return!1;return!0}}function C(e){return w(t);function t(n){return n&&n.type===e}}function w(e){return t;function t(n,o,i){return!!(q(n)&&e.call(this,n,typeof o=="number"?o:void 0,i||void 0))}}function V(){return!0}function q(e){return e!==null&&typeof e=="object"&&"type"in e}const I=[],Y=!0,D=!1,_="skip";function B(e,t,n,o){let i;typeof t=="function"&&typeof n!="function"?(o=n,n=t):i=t;const c=A(i),s=o?-1:1;d(e,void 0,[])();function d(r,m,u){const l=r&&typeof r=="object"?r:{};if(typeof l.type=="string"){const a=typeof l.tagName=="string"?l.tagName:typeof l.name=="string"?l.name:void 0;Object.defineProperty(k,"name",{value:"node ("+(r.type+(a?"<"+a+">":""))+")"})}return k;function k(){let a=I,g,p,v;if((!t||c(r,m,u[u.length-1]||void 0))&&(a=H(n(r,u)),a[0]===D))return a;if("children"in r&&r.children){const y=r;if(y.children&&a[0]!==_)for(p=(o?y.children.length:-1)+s,v=u.concat(y);p>-1&&p<y.children.length;){const T=y.children[p];if(g=d(T,p,v)(),g[0]===D)return g;p=typeof g[1]=="number"?g[1]:p+s}}return a}}}function H(e){return Array.isArray(e)?e:typeof e=="number"?[Y,e]:e==null?I:[e]}function K(e,t,n,o){let i,c,s;typeof t=="function"&&typeof n!="function"?(c=void 0,s=t,i=n):(c=t,s=n,i=o),B(e,c,d,i);function d(r,m){const u=m[m.length-1],l=u?u.children.indexOf(r):void 0;return s(r,l,u)}}const P=function(){return e=>{K(e,t=>{const n=t;if(n.name!=="today")return;const o=n.attributes.date,i="today-"+Math.random().toString(36).slice(2);n.type="html",n.value=`<div id="${i}"></div>`;const c=setInterval(()=>{document.querySelector("#"+i)!=null&&(document.querySelector("#"+i).innerHTML=U(o),clearInterval(c))},100)})}},U=function(e){const t=e?new Date(e):new Date,n=t.getFullYear(),o=t.getMonth(),i=t.getDate(),c=t.getDay(),s=c===0?i-6:i-(c-1),d=s+7;var r=[];return r.push('<fieldset class="today-fieldset">'),r.push("<legend>"+t.toISOString().slice(0,10)+"</legend>"),r.push(n.toString()),r.push("<br/>"),r.push(h(new Date(n,0,1),new Date(n+1,0,1),t)),r.push("<br/>"),r.push(t.toLocaleDateString("en",{month:"long"})),r.push("<br/>"),r.push(h(new Date(n,o,1),new Date(n,o+1,1),t)),r.push("<br/>"),r.push("Week "+X(t)),r.push("<br/>"),r.push(h(new Date(n,o,s),new Date(n,o,d),t)),r.push("<br/>"),r.push(t.toLocaleDateString("en",{weekday:"long"})),r.push("<br/>"),r.push(h(new Date(n,o,i),new Date(n,o,i+1),t)),r.push("</fieldset>"),r.join("")},b=24*60*60*1e3,h=function(e,t,n){const o=(t.getTime()-e.getTime())/b,i=(n.getTime()-e.getTime())/b,c=Math.floor(i/o*100),s=i.toFixed(2);return`<meter value="${i}" min="0" max="${o}" title="${c}% (${s}/${o})">${c}% (${s}/${o})</meter>`},X=function(e){const t=e.getFullYear(),n=$(e,t);return n===0?$(e,t-1):n},$=function(e,t){let n=0;switch(new Date(t,0,1).getDay()){case 0:n=1;break;case 1:n=0;break;case 2:n=-1;break;case 3:n=-2;break;case 4:n=-3;break;case 5:n=3;break;case 6:default:n=2;break}const o=new Date(t,0,1+n);return Math.ceil(((e.getTime()-o.getTime())/b+1)/7)},z=()=>{if(console.log(`Activating ${f.name} v${f.version}...`),growiFacade==null||growiFacade.markdownRenderer==null)return;const{optionsGenerators:e}=growiFacade.markdownRenderer,t=e.customGenerateViewOptions,n=e.customGeneratePreviewOptions;e.customGenerateViewOptions=(...o)=>{const i=t?t(...o):e.generateViewOptions(...o);return i.remarkPlugins.push(P),console.log("todayPlugin added to view options:",i.remarkPlugins),i},e.customGeneratePreviewOptions=(...o)=>{const i=n?n(...o):e.generatePreviewOptions(...o);return i.remarkPlugins.push(P),i},console.log(`${f.name} activated.`)},J=()=>{};window.pluginActivators==null&&(window.pluginActivators={});window.pluginActivators[f.name]={activate:z,deactivate:J};console.log(`${f.name} v${f.version} is loaded.`);
